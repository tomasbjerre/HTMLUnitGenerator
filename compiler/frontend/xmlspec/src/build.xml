<project name="xmltestparser" default="build" basedir=".">
    <property name="parser.name" value="Parser" />
    <taskdef classname="jastadd.JastAddTask" name="jastadd" classpath="tools/jastadd2.jar" />

    <target name="compile" depends="build">
        <javac srcdir="." classpath="../target/classes" />
    </target>

    <target name="build">
        <mkdir dir="xml/parser" />
        <jastadd package="xml.parser" jjtree="true" grammar="${parser.name}">
            <fileset dir=".">
                <include name="**/*.ast" />
                <include name="**/*.jrag" />
                <include name="**/*.jadd" />
            </fileset>
        </jastadd>
        <jjtree target="${parser.name}.jjt"
                outputdirectory="xml/parser"
                javacchome="tools"
                buildnodefiles="true"
                static="false"
                multi="true"
                visitor="true"
                nodedefaultvoid="true"
                nodeprefix='""'
                nodepackage="xml.parser" />
        <javacc target="xml/parser/${parser.name}.jj"
                outputdirectory="xml/parser"
                javacchome="tools"
                buildparser="true"
                buildtokenmanager="true"
                static="false" />
        <touch>
            <fileset dir="." includes="**/*.java" />
        </touch>
    </target>

    <target name="doc" depends="build" description="Generate the grammar as html">
        <jjdoc target="xml/parser/${parser.name}.jj" javacchome="tools" />
    </target>

    <target name="clean" description="Delete generated files.">
        <delete dir="xml/parser" />
        <delete file="${parser.name}.html" />
        <delete>
            <fileset dir="." includes="**/*.class" />
        </delete>
    </target>
</project>
